var h={37:0,38:0,39:0,40:0},R=function(e){var a=e.keyCode;(65==a||32==a||a>36&&41>a)&&(h[a]="keydown"===e.type?!0:!1)};onkeydown=onkeyup=R;var D=["b","a","g","y","o","r"],x=["DodgerBlue","Aqua","Lime","Gold","Orange","Red"],c=function(e,a){return e.clearRect(0,0,a,a),new Image},L=function(a){for(var s=a.canvas,u=0;u<x.length;u++){var h=f[D[u]]={},e=c(a,t);a.fillStyle=x[u],a.beginPath(),a.arc(r,r,r,0,2*Math.PI),a.fill(),e.src=s.toDataURL("image/png"),h.circle=e;var e=c(a,t);a.fillRect(0,0,t,t),e.src=s.toDataURL("image/png"),h.rect=e;var e=c(a,t);a.beginPath();var i=[r,0,t,d,t,y,r,t,0,y,0,d];a.moveTo(i[0],i[1]);for(var n=2;n<i.length-1;n+=2)a.lineTo(i[n],i[n+1]);a.fill(),e.src=s.toDataURL("image/png"),h.hex=e;var e=c(a,t);a.beginPath();var p=[r,0,t,t,0,t];a.moveTo(p[0],p[1]);for(var n=2;n<i.length-1;n+=2)a.lineTo(p[n],p[n+1]);a.fill(),e.src=s.toDataURL("image/png"),h.tri=e,c(a,o)}},u=function(t,r,n,o,c,i){var a=this;a.p=r||new e(0,0),a.v=n||new e(0,0),a.a=o||new e(0,0),a.r=0,a.d=c||.9,this.c=i||0,a.i=t,a.m=[],a.z=!1};u.prototype={constructor:u,u:function(t,i){var a=this,e=a.p,o=a.v,c=a.a;o.a(c),e.a(o),o.m(a.d),c.s(0,0),e.y<n.near?(e.y=n.far,a.c=m[3],a.z&&s(0)):e.y>n.far?(e.y=n.near,a.c=m[0],a.z&&s(1)):e.x<n.near?(e.x=n.far,a.c=g[0],a.z&&s(2)):e.x>n.far&&(e.x=n.near,a.c=g[3],a.z&&s(3)),a.r=Math.atan2(o.y,o.x)+I,a.c===i&&(t.save(),t.translate(e.x,e.y),t.rotate(a.r),t.drawImage(a.i,-r,-r),t.restore())},um:function(t,r){for(var e=this,a=0;a<e.m.length;a++)e.m[a].u(t,r)},f:function(){var a=this;a.m.push(new u(f.b.tri,new e(a.p.x,a.p.y),new e(a.v.x,a.v.y),null,1,a.c))}};var e=function(e,t){var a=this;a.x=e,a.y=t};e.prototype={constructor:e,s:e,a:function(a){var e=this;e.x+=a.x,e.y+=a.y},m:function(a){var e=this;e.x*=a,e.y*=a}};var v=Math.PI,P=v/4,I=v/2,U=2*v,o=320,z=160,t=16,r=8,d=4,y=12,n={far:o+r,near:-r},b=document.getElementById("c"),l=[],f={},T,p=.8,k={37:new e(-p,0),38:new e(0,-p),39:new e(p,0),40:new e(0,p)},i=1,m=[0,1,2,3],g=[0,4,2,5],a=[[0,0,0,0,0,0,1,0],[0,-160,-160,90,0,0,i,1],[0,0,-320,0,180,0,i,2],[0,160,-160,-90,0,0,i,3],[-160,0,-160,0,-90,0,i,4],[160,0,-160,0,90,0,i,5]],s=function(r){var e=[];switch(r){case 0:e.push(a[3]);for(var t=0;3>t;t++)e.push(a[t]);for(var t=4;6>t;t++)e.push(a[t]);break;case 1:for(var t=1;4>t;t++)e.push(a[t]);e.push(a[0]);for(var t=4;6>t;t++)e.push(a[t]);break;case 2:e.push(a[4]),e.push(a[1]),e.push(a[5]),e.push(a[3]),e.push(a[2]),e.push(a[0]);break;case 3:e.push(a[5]),e.push(a[1]),e.push(a[4]),e.push(a[3]),e.push(a[0]),e.push(a[2])}a=e},w=function(){requestAnimationFrame(w);for(var e=0;6>e;e++){var t=l[e];if(t.clearRect(0,0,o,o),j(t.canvas,a[e]),object.u(t,e),object.um(t,e),object.c===e){for(var r=37;41>r;r++)h[r]&&object.a.a(k[r]);h[32]&&object.f(),h[65]&&(object.m=[])}}},j=function(t,a){var e=t.style;e.opacity=a[6],e.transform="perspective(320px) translate3d("+a[0]+"px, "+a[1]+"px, "+a[2]+"px) rotateX("+a[3]+"deg) rotateY("+a[4]+"deg) rotateZ("+a[5]+"deg)"};window.onload=function(){for(var e=0;6>e;e++){var a=document.createElement("canvas");a.width=a.height=o,b.appendChild(a),l.push(a.getContext("2d"))}L(l[0]),object=new u(f.y.tri),object.p.s(z,o),w()};