var l=.64,L={37:new a(-l,0),38:new a(0,-l),39:new a(l,0),40:new a(0,l)},u={37:0,38:0,39:0,40:0},U=function(e){var a=e.keyCode;(65==a||32==a||a>36&&41>a)&&(u[a]="keydown"===e.type?!0:!1)};onkeydown=onkeyup=U;var h={},C=["b","a","g","y","o","r"],k=["DodgerBlue","Aqua","Lime","Gold","Orange","Red"],i=function(e,a){return e.clearRect(0,0,a,a),new Image},q=function(a){for(var f=a.canvas,l=0;l<k.length;l++){var s=h[C[l]]={},r=i(a,e);a.fillStyle=k[l],a.beginPath(),a.arc(t,t,t,0,2*Math.PI),a.fill(),r.src=f.toDataURL("image/png"),s.circle=r;var r=i(a,e);a.fillRect(0,0,e,e),r.src=f.toDataURL("image/png"),s.rect=r;var r=i(a,e);a.beginPath();var o=[t,0,e,m,e,x,t,e,0,x,0,m];a.moveTo(o[0],o[1]);for(var n=2;n<o.length-1;n+=2)a.lineTo(o[n],o[n+1]);a.fill(),r.src=f.toDataURL("image/png"),s.hex=r;var r=i(a,e);a.beginPath();var v=[t,0,e,e,0,e];a.moveTo(v[0],v[1]);for(var n=2;n<o.length-1;n+=2)a.lineTo(v[n],v[n+1]);a.fill(),r.src=f.toDataURL("image/png"),s.tri=r,i(a,c)}},a=function(e,t){var a=this;a.x=e,a.y=t};a.prototype={constructor:a,s:a,a:function(a){var e=this;e.x+=a.x,e.y+=a.y},m:function(a){var e=this;e.x*=a,e.y*=a}};var v=function(t,r,n,o,c,i){var e=this;e.p=r||new a(0,0),e.v=n||new a(0,0),e.a=o||new a(0,0),e.r=0,e.d=c||.9,this.c=i||0,e.i=t,e.m=[],e.z=!1,e.ft=0};v.prototype={constructor:v,u:function(r,i,l){var a=this,e=a.p,o=a.v,c=a.a;o.a(c),e.a(o),o.m(a.d),c.s(0,0),a.ft>0&&a.ft--,e.y<n.near?(e.y=n.far,a.c=f(a.c,!0,1),a.z&&p(0)):e.y>n.far?(e.y=n.near,a.c=f(a.c,!0,-1),a.z&&p(1)):e.x<n.near?(e.x=n.far,a.c=f(a.c,!1,1),a.z&&p(2)):e.x>n.far&&(e.x=n.near,a.c=f(a.c,!1,-1),a.z&&p(3)),2!==l&&(a.r=Math.atan2(o.y,o.x)+M,a.c===i&&(r.save(),r.translate(e.x,e.y),r.rotate(a.r),r.drawImage(a.i,-t,-t),r.restore()))},um:function(t,r,a){for(var e=this,a=0;a<e.m.length;a++)e.m[a].u(t,r,a)},f:function(){var e=this;0===e.ft&&(e.ft=60,e.m.push(new v(h.b.tri,new a(e.p.x,e.p.y),new a(e.v.x,e.v.y),null,1,e.c)))}};var y=Math.PI,A=y/4,M=y/2,F=2*y,c=320,P=160,e=16,t=8,m=4,x=12,n={far:c+t,near:-t},z=document.getElementById("c"),g=[],s=.12,B=!1,D=[[0,0,0,0,0,0,1],[0,-160,-160,90,0,0,s],[0,0,-320,0,180,0,0],[0,160,-160,-90,0,0,s],[-160,0,-160,0,-90,0,s],[160,0,-160,0,90,0,s]],r=[0,1,2,3],o=[0,4,2,5],T=[],E=[],f=function(t,n,c){for(var e=n?r:o,a=0;a<e.length&&e[a]!==t;a++);return a+=c,0>a&&(a=3),a>3&&(a=0),e[a]},w=function(a,e){e[0]=a[0],e[2]=a[2]},d=function(a){a.push(a.shift()),w(a,a===r?o:r)},b=function(a){a.unshift(a.pop()),w(a,a===r?o:r)},p=function(a){switch(a){case 0:T=r,d(r);break;case 1:b(r);break;case 2:d(o);break;case 3:b(o)}},R=function(){for(var a=0;6>a;a++){var t=4>a?r[a]:4===a?o[1]:o[3],e=g[t];if(e.clearRect(0,0,c,c),I(e.canvas,D[a]),e.canvas.style.zIndex=0===a?999:0,player.um(e,t,a),player.u(e,t,a),player.c===t){for(var n=37;41>n;n++)u[n]&&player.a.a(L[n]);u[32]&&player.f(),u[65]&&(player.m=[])}}requestAnimationFrame(R)},I=function(t,a){var e=t.style;e.opacity=a[6],e.transform="perspective(40px) translate3d("+a[0]+"px, "+a[1]+"px, "+a[2]+"px) rotateX("+a[3]+"deg) rotateY("+a[4]+"deg) rotateZ("+a[5]+"deg)"};window.onload=function(){for(var e=0;6>e;e++){var a=document.createElement("canvas");a.width=a.height=c,z.appendChild(a),g.push(a.getContext("2d"))}q(g[0]),player=new v(h.y.tri),player.z=!0,player.p.s(P,c),R()};